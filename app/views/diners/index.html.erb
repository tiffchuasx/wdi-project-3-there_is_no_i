<div class="container">
<h1>Diners</h1>
<p>Current Time: <%= Time.now%></p>

<h2>Awaiting</h2>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Phone</th>
      <th>Email</th>
      <th>Quantity</th>
      <th>Status</th>
      <th>Queue Number</th>
      <th>Table</th>
      <th>Requests</th>
      <th>Start Time</th>
      <th>Est End Time</th>
    </tr>
  </thead>
  <tbody>
    <% @diners.where(status:'awaiting').each do |diner| %>
    <tr>
      <td><%= link_to diner.name, restaurant_edit_diner_path(@restaurant.id, diner) %></td>
      <td><%= diner.phone %></td>
      <td><%= diner.email %></td>
      <td><%= diner.party_size %></td>
      <td>
        <% if diner.status == 'awaiting' %>
        <font color="red"><b><%= diner.status %></b></font>
        <% else %>
        <%= diner.status %>
        <% end %>
      </td>
      <td><%= diner.queue_number %></td>
      <td>
        <% if diner.table_id != nil %>
        <%= Table.find(diner.table_id).name %>
        <% end %>
      </td>
      <td><%= diner.special_requests %></td>
      <td>
        <% if diner.start_time != nil %>
        <%= diner.start_time.getlocal('+08:00') %>
        <% end %>
      </td>
      <td>
        <% if diner.end_time %>
        <% if Time.now > diner.end_time %>
        <font color="red"><b><%= diner.end_time.getlocal('+08:00') %></b></font>
        <% else %>
        <%= diner.end_time.getlocal('+08:00') %>
        <% end %>
        <% end %>
      </td>
    </tr>
    <% end %>
  </tbody>
</table>

<h2>Current</h2>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Phone</th>
      <th>Email</th>
      <th>Quantity</th>
      <th>Status</th>
      <th>Queue Number</th>
      <th>Table</th>
      <th>Requests</th>
      <th>Start Time</th>
      <th>Est End Time</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <% @diners.where(status:'dining').each do |diner| %>
    <tr>
      <!-- <td><%= link_to diner.name, restaurant_diner_path(@restaurant.id, diner) %></td> -->
      <td><%= link_to diner.name, restaurant_edit_diner_path(@restaurant.id, diner) %></td>
      <td><%= diner.phone %></td>
      <td><%= diner.email %></td>
      <td><%= diner.party_size %></td>
      <td>
        <% if diner.status == 'awaiting' %>
        <font color="red"><b><%= diner.status %></b></font>
        <% else %>
        <%= diner.status %>
        <% end %>
      </td>
      <td><%= diner.queue_number %></td>
      <td>
        <% if diner.table_id != nil %>
        <%= Table.find(diner.table_id).name %>
        <% end %>
      </td>
      <td><%= diner.special_requests %></td>
      <td>
        <% if diner.start_time != nil %>
        <%= diner.start_time.getlocal('+08:00') %>
        <% end %>
      </td>
      <td>
        <% if diner.end_time %>
        <% if Time.now > diner.end_time %>
        <font color="red"><b><%= diner.end_time.getlocal('+08:00') %></b></font>
        <% else %>
        <%= diner.end_time.getlocal('+08:00') %>
        <% end %>
        <% end %>
      </td>
      <!-- <td><%= link_to 'Show', restaurant_diner_path(@restaurant.id, diner) %></td> -->
      <!-- <td><%= link_to 'Edit', restaurant_edit_diner_path(@restaurant.id, diner) %></td> -->
      <!-- <%= link_to 'Destroy', restaurant_diner_path(@restaurant.id, diner), method: :delete, data: { confirm: 'Are you sure?' } %> -->
    </tr>
    <% end %>
  </tbody>
</table>
</div>
