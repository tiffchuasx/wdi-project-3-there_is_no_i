<h1>Menu</h1>
<%= link_to "Back to Restaurant", restaurant_path(@restaurant) %>

<% if !current_user or current_user.restaurants.include? @restaurant %>
<%= link_to 'New Menu Item', new_restaurant_menu_item_path(@restaurant.id) %>
<% end %>

<br>

<button id="takeaway-show-hide" type="button" name="button">Order Takeaway</button>

<h1>Sort by:</h1>
<a class="button is-primary" href="/restaurants/<%= @restaurant_id %>/menu_items?name=sort">Name</a>
<a class="button is-primary" href="/restaurants/<%= @restaurant_id %>/menu_items?price=sort">Price</a>
<a class="button is-primary" href="/restaurants/<%= @restaurant_id %>/menu_items?description=sort">Description</a>
<a class="button is-primary" href="/restaurants/<%= @restaurant_id %>/menu_items?ingredient=sort">Ingredient</a>
<a class="button is-primary" href="/restaurants/<%= @restaurant_id %>/menu_items?tag=sort">Tag</a>
<div class="all-menu-items">
<% @menu_items.each do |item| %>
<p>
  Name:
  <%= item.name %>
</p>
<p>
  Price:
  <%= formatPrice(item.price) %>
</p>
<p>
  Description:
  <%= item.description %>
</p>
<p>
  Ingredients:
  <%= item.ingredients %>
</p>
<p>
  Tags:
  <%= item.tags %>
</p>

<button class="add-to-order" style="display:none" type="button" name="button" value='<%= item.id.to_s + '/' + item.name + '/' + item.price.to_s %>'>Add to Order</button>

<%= link_to 'Show', restaurant_menu_item_path(@restaurant.id, item) %>
<% if !current_user or current_user.restaurants.include? @restaurant %>
 |
<%= link_to 'Edit', edit_restaurant_menu_item_path(@restaurant.id, item) %> |
<%= link_to 'Destroy', restaurant_menu_item_path(@restaurant.id, item), method: :delete, data: { confirm: 'Are you sure?' } %>
<% end %>

<br>
<br>

<% end %>
</div>

<div style="display:none" class="ordered-items">

<ul class="ordered-items-list">
</ul>

<%= form_for :order, remote: true, url: restaurant_invoices_path(@restaurant.id), html: {class:'ordered-items-form'} do |f| %>
  <%= hidden_field_tag :orders %>
  <%= hidden_field_tag :total_price %>
  <%= hidden_field_tag :is_take_away, @is_take_away %>
  <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
  <% if !current_user || !current_user.restaurants.include?(@restaurant) %>
    <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
    data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
    data-name="<%= @restaurant.name %>"
    data-amount=""
    data-description='Order'
    data-locale="auto"
    data-currency="SGD"></script>
  <% else %>
    <%= f.submit 'Create Orders', id: 'create-orders-button'%>
  <% end %>
<% end %>
</div>

<%= javascript_include_tag('menu_items/takeaway.js') %>
